<div class="row mb-3">
  <div class="col-6">
    <h3 class="primary-text m-0">{{ 'menu.settings.title' | translate }}</h3>
  </div>
  <div class="col-6 text-end">
    <button
      type="button"
      class="btn btn-elegant my-0 me-0"
      (click)="openSupport()"
      [attr.aria-label]="'support.title' | translate"
    >
      <i class="fa fa-fw fa-question-circle-o"></i>
    </button>
  </div>
</div>

@if (loading) {
<app-spinner />
} @else {
<!-- GENERAL SETTINGS -->
<div class="my-4">
  <div
    role="button"
    tabindex="0"
    [attr.aria-expanded]="showFields.general ? 'true' : 'false'"
    [attr.aria-controls]="'fieldsGeneral'"
    (click)="toggleSection('general')"
    class="mt-3 hover-pointer"
  >
    <h5 class="primary-text">
      <i
        class="fa fa-fw"
        [ngClass]="{ 'fa-chevron-down': showFields.general, 'fa-chevron-right': !showFields.general }"
      ></i>
      {{ 'settings.general.title_general' | translate }}
    </h5>
  </div>
  @if (showFields.general) {
  <ul class="list-group list-group-box mt-2 mx-0" id="fieldsGeneral">
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>{{ 'settings.name' | translate }}</span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          [formControl]="hbNameFormControl"
          [attr.aria-label]="('settings.name' | translate)"
          [ngClass]="{ 'is-invalid': hbNameIsInvalid }"
        />
        @if (hbNameIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2"> {{ 'backup.title_backup' | translate }} </span>
      <button
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        (click)="openBackupModal()"
        [attr.aria-label]="'backup.title_backup' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2"> {{ 'menu.tooltip_user_accounts' | translate }} </span>
      <a
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        routerLink="/users"
        [attr.aria-label]="'menu.tooltip_user_accounts' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </a>
    </li>
  </ul>
  }
</div>

<!-- DISPLAY SETTINGS -->
<div class="my-4">
  <div
    role="button"
    tabindex="0"
    [attr.aria-expanded]="showFields.display ? 'true' : 'false'"
    [attr.aria-controls]="'fieldsDisplay'"
    (click)="toggleSection('display')"
    class="mt-3 hover-pointer"
  >
    <h5 class="primary-text">
      <i
        class="fa fa-fw"
        [ngClass]="{ 'fa-chevron-down': showFields.display, 'fa-chevron-right': !showFields.display }"
      ></i>
      {{ 'settings.general.title_display' | translate }}
    </h5>
  </div>
  @if (showFields.display) {
  <ul class="list-group list-group-box mt-2 mx-0" id="fieldsDisplay">
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      {{ 'settings.display.lang' | translate }}
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <select class="custom-select resp-select order-1 order-md-2" [formControl]="uiLangFormControl">
          <option value="auto">{{ 'form.select.auto' | translate }}</option>
          <option value="bg">Bulgarian (bg)</option>
          <option value="ca">Catalan (ca)</option>
          <option value="zh-CN">Chinese - Simplified (zh-CN)</option>
          <option value="zh-TW">Chinese - Traditional (zh-TW)</option>
          <option value="cs">Czech (cs)</option>
          <option value="nl">Dutch (nl)</option>
          <option value="en">English (en)</option>
          <option value="fi">Finnish (fi)</option>
          <option value="fr">French (fr)</option>
          <option value="de">German (de)</option>
          <option value="he">Hebrew (he)</option>
          <option value="hu">Hungarian (hu)</option>
          <option value="id">Indonesian (id)</option>
          <option value="it">Italian (it)</option>
          <option value="ja">Japanese (ja)</option>
          <option value="ko">Korean (ko)</option>
          <option value="mk">Macedonian (mk)</option>
          <option value="no">Norwegian (no)</option>
          <option value="pl">Polish (pl)</option>
          <option value="pt-BR">Portuguese (Brazil)</option>
          <option value="pt">Portuguese (Portugal)</option>
          <option value="ru">Russian (ru)</option>
          <option value="sl">Slovenian (sl)</option>
          <option value="es">Spanish (es)</option>
          <option value="sv">Swedish (sv)</option>
          <option value="th">Thai (th)</option>
          <option value="tr">Turkish (tr)</option>
          <option value="uk">Ukrainian (uk)</option>
        </select>
        @if (uiLangIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      {{ 'settings.display.theme' | translate }}
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <select class="custom-select resp-select order-1 order-md-2" [formControl]="uiThemeFormControl">
          <option value="orange">{{ 'settings.display.orange' | translate }}</option>
          <option value="red">{{ 'settings.display.red' | translate }}</option>
          <option value="pink">{{ 'settings.display.pink' | translate }}</option>
          <option value="purple">{{ 'settings.display.purple' | translate }}</option>
          <option value="deep-purple">{{ 'settings.display.deep_purple' | translate }}</option>
          <option value="indigo">{{ 'settings.display.indigo' | translate }}</option>
          <option value="blue">{{ 'settings.display.blue' | translate }}</option>
          <option value="blue-grey">{{ 'settings.display.bluegrey' | translate }}</option>
          <option value="cyan">{{ 'settings.display.cyan' | translate }}</option>
          <option value="green">{{ 'settings.display.green' | translate }}</option>
          <option value="teal">{{ 'settings.display.teal' | translate }}</option>
          <option value="grey">{{ 'settings.display.grey' | translate }}</option>
          <option value="brown">{{ 'settings.display.brown' | translate }}</option>
        </select>
        @if (uiThemeIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      {{ 'settings.display.lighting_mode' | translate }}
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <select class="custom-select resp-select order-1 order-md-2" [formControl]="uiLightFormControl">
          <option value="auto">{{ 'form.select.auto' | translate }}</option>
          <option value="light">{{ 'settings.display.light' | translate }}</option>
          <option value="dark">{{ 'settings.display.dark' | translate }}</option>
        </select>
        @if (uiLightIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      {{ 'settings.display.menu_mode' | translate }}
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <select class="custom-select resp-select order-1 order-md-2" [formControl]="uiMenuFormControl">
          <option value="default">{{ 'settings.display.menu_default' | translate }}</option>
          <option value="freeze">{{ 'settings.display.menu_freeze' | translate }}</option>
        </select>
        @if (uiMenuIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      {{ 'settings.display.temp_units' | translate }}
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <select class="custom-select resp-select order-1 order-md-2" [formControl]="uiTempFormControl">
          <option value="c">{{ 'settings.display.temp_units.c' | translate }}</option>
          <option value="f">{{ 'settings.display.temp_units.f' | translate }}</option>
        </select>
        @if (uiTempIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2">{{ 'settings.display.wallpaper' | translate }}</span>
      <button
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        (click)="openWallpaperModal()"
        [attr.aria-label]="'settings.display.wallpaper' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </button>
    </li>
  </ul>
  }
</div>

<!-- STARTUP/ENV OPTIONS -->
<div class="my-4">
  <div
    role="button"
    tabindex="0"
    [attr.aria-expanded]="showFields.startup ? 'true' : 'false'"
    [attr.aria-controls]="'fieldsStartup'"
    (click)="toggleSection('startup')"
    class="mt-3 hover-pointer"
  >
    <h5 class="primary-text">
      <i
        class="fa fa-fw"
        [ngClass]="{ 'fa-chevron-down': showFields.startup, 'fa-chevron-right': !showFields.startup }"
      ></i>
      {{ 'settings.title_startup_options' | translate }}
    </h5>
  </div>
  @if (showFields.startup) {
  <ul class="list-group list-group-box mb-4 mx-0" id="fieldsStartup">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.startup.debug' | translate }} <code>-D</code><br />
        <small class="grey-text pe-2">
          {{ (isHbV2 ? 'settings.startup.debug_desc_v2' : 'settings.startup.debug_desc_v1') | translate }}
        </small>
      </span>
      <div class="d-flex align-items-center">
        <div class="order-1 order-md-2">
          <input
            type="checkbox"
            class="rendux-input"
            id="homebridgeDebugMode"
            [formControl]="hbDebugFormControl"
            [attr.aria-label]="'settings.startup.debug' | translate"
          />
          <label for="homebridgeDebugMode" class="rendux-label ms-3" style="min-width: 50px"></label>
        </div>
        @if (hbDebugIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.startup.insecure' | translate }} <code>-I</code><br />
        <small class="grey-text pe-2">{{ 'settings.startup.insecure_desc' | translate }}</small>
      </span>
      <div class="d-flex align-items-center">
        <div class="order-1 order-md-2">
          <input
            type="checkbox"
            class="rendux-input"
            id="homebridgeInsecureMode"
            [formControl]="hbInsecureFormControl"
            [attr.aria-label]="'settings.startup.insecure' | translate"
          />
          <label for="homebridgeInsecureMode" class="rendux-label ms-3" style="min-width: 50px"></label>
        </div>
        @if (hbInsecureIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.startup.keep_accessories' | translate }} <code>-K</code><br />
        <small class="grey-text pe-2">{{ 'settings.startup.keep_accessories_desc' | translate }}</small>
      </span>
      <div class="d-flex align-items-center">
        <div class="order-1 order-md-2">
          <input
            type="checkbox"
            class="rendux-input"
            id="homebridgeKeepOrphans"
            [formControl]="hbKeepFormControl"
            [attr.aria-label]="'settings.startup.keep_accessories' | translate"
          />
          <label for="homebridgeKeepOrphans" class="rendux-label ms-3" style="min-width: 50px"></label>
        </div>
        @if (hbKeepIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.startup.metrics' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.startup.metrics_desc' | translate }}</small>
      </span>
      <div class="d-flex align-items-center">
        <div class="order-1 order-md-2">
          <input
            type="checkbox"
            class="rendux-input"
            id="homebridgeMetrics"
            [formControl]="uiMetricsFormControl"
            [attr.aria-label]="'settings.startup.metrics' | translate"
          />
          <label for="homebridgeMetrics" class="rendux-label ms-3" style="min-width: 50px"></label>
        </div>
        @if (uiMetricsIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.network.hb_package' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.network.hb_package_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          placeholder="/usr/local/lib/node_modules/homebridge"
          [formControl]="hbPackageFormControl"
          [attr.aria-label]="('settings.network.hb_package' | translate)"
        />
        @if (hbPackageIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    @if (platform === 'linux') {
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.linux.shutdown' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.linux.shutdown_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          placeholder="shutdown"
          [formControl]="hbLinuxShutdownFormControl"
          [attr.aria-label]="('settings.linux.shutdown' | translate)"
        />
        @if (hbLinuxShutdownIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.linux.restart' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.linux.restart_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          placeholder="reboot"
          [formControl]="hbLinuxRestartFormControl"
          [attr.aria-label]="('settings.linux.restart' | translate)"
        />
        @if (hbLinuxRestartIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    @if (runningOnRaspberryPi) {
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.linux.temp' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.linux.temp_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          placeholder="/sys/class/thermal/thermal_zone0/temp"
          [formControl]="uiTempFileFormControl"
          [attr.aria-label]="('settings.linux.temp' | translate)"
        />
        @if (uiTempFileIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    } }
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        <span class="font-monospace">DEBUG</span><br />
        <small
          class="grey-text pe-2"
          [innerHTML]="'settings.service.debug_tooltip' | translate: { link: linkDebug }"
        ></small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          [formControl]="hbEnvDebugFormControl"
          type="text"
          placeholder="HAP-NodeJS:Advertiser,HAP-NodeJS:Service"
        />
        @if (hbEnvDebugIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        <span class="font-monospace">NODE_OPTIONS</span><br />
        <small class="grey-text pe-2">{{ 'settings.service.node_tooltip' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          [formControl]="hbEnvNodeFormControl"
          type="text"
          placeholder="--max-old-space-size=512 --max-http-header-size=8192"
        />
        @if (hbEnvNodeIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    @if (runningInDocker) {
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        {{ 'menu.docker.startup_script' | translate }}<br />
        <small class="grey-text pe-2">{{ 'platform.docker.script_help' | translate }}</small>
      </span>
      <a
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        routerLink="/platform-tools/docker/startup-script"
        [attr.aria-label]="'menu.docker.startup_script' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </a>
    </li>
    }
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.startup.log_max' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.startup.log_max_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="number"
          min="-1"
          placeholder="1000000"
          [formControl]="hbLogSizeFormControl"
          [attr.aria-label]="'settings.startup.log_max' | translate"
          [ngClass]="{ 'is-invalid': hbLogSizeIsInvalid }"
        />
        @if (hbLogSizeIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    @if (hbLogSizeFormControl.value > 0) {
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.startup.log_truncate' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.startup.log_truncate_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="number"
          min="0"
          placeholder="200000"
          [formControl]="hbLogTruncateFormControl"
          [attr.aria-label]="'settings.startup.log_truncate' | translate"
          [ngClass]="{ 'is-invalid': hbLogTruncateIsInvalid }"
        />
        @if (hbLogTruncateIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    }
  </ul>
  }
</div>

<!-- NETWORK SETTINGS -->
<div class="my-4">
  <div
    role="button"
    tabindex="0"
    [attr.aria-expanded]="showFields.network ? 'true' : 'false'"
    [attr.aria-controls]="'fieldsNetwork'"
    (click)="toggleSection('network')"
    class="mt-3 hover-pointer"
  >
    <h5 class="primary-text">
      <i
        class="fa fa-fw"
        [ngClass]="{ 'fa-chevron-down': showFields.network, 'fa-chevron-right': !showFields.network }"
      ></i>
      {{ 'settings.network.title_network' | translate }}
    </h5>
  </div>
  @if (showFields.network) {
  <ul class="list-group list-group-box mt-2 mx-0" id="fieldsNetwork">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2">
        {{ 'settings.network.title_network_interfaces' | translate }}<br />
        <div class="small grey-text pe-2">{{ 'settings.network.message_network_interface' | translate }}</div>
        @for (adapter of adaptersSelected; track adapter) {
        <span
          class="badge badge-primary me-1"
          [ngClass]="{ 'badge-danger': adapter.missing, 'badge-info': !adapter.missing }"
        >
          @if (adapter.missing) {
          <i class="fas fa-fw fa-exclamation-triangle"></i>
          } {{ adapter.iface }}:
          <span class="fw-normal"
            >{{ adapter.missing ? ('settings.mdns_advertiser_not_connected' | translate) : adapter.ip4 || adapter.ip6
            }}</span
          >
        </span>
        }
      </span>
      <button
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        (click)="selectNetworkInterfaces()"
        [disabled]="!adaptersAvailable.length"
        [attr.aria-label]="'settings.network.title_network_interfaces' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </button>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.mdns_advertiser' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.mdns_advertiser_help' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <select
          class="custom-select resp-select order-1 order-md-2"
          [formControl]="hbMDnsFormControl"
          [attr.aria-label]="'settings.mdns_advertiser' | translate"
        >
          @if (showAvahiMdnsOption) {
          <option value="avahi">Avahi ({{ 'settings.mdns_advertiser_rec' | translate }})</option>
          }
          <!-- ciao is recommended if avahi is not available -->
          <option value="ciao">
            Ciao {{ showAvahiMdnsOption ? '' : '(' + ('settings.mdns_advertiser_rec' | translate) + ')' }}
          </option>
          <option value="bonjour-hap">Bonjour HAP</option>
          @if (showResolvedMdnsOption) {
          <option value="resolved">systemd-resolved ({{ 'settings.mdns_advertiser_exp' | translate }})</option>
          }
        </select>
        @if (hbMDnsIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.network.port_hb' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.network.port_hb_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="number"
          min="1025"
          max="65533"
          [formControl]="hbPortFormControl"
          [attr.aria-label]="('settings.network.port_hb' | translate)"
          [ngClass]="{ 'is-invalid': hbPortIsInvalid }"
        />
        @if (hbPortIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.network.port_ui' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.network.port_ui_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="number"
          min="1025"
          max="65533"
          placeholder="8581"
          [formControl]="uiPortFormControl"
          [attr.aria-label]="('settings.network.port_ui' | translate)"
          [ngClass]="{ 'is-invalid': uiPortIsInvalid }"
        />
        @if (uiPortIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.network.port_start' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.network.port_start_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="number"
          min="1025"
          max="65533"
          [formControl]="hbStartPortFormControl"
          [attr.aria-label]="('settings.network.port_start' | translate)"
          [ngClass]="{ 'is-invalid': hbStartPortIsInvalid }"
        />
        @if (hbStartPortIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.network.port_end' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.network.port_end_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="number"
          min="1025"
          max="65533"
          [formControl]="hbEndPortFormControl"
          [attr.aria-label]="('settings.network.port_end' | translate)"
          [ngClass]="{ 'is-invalid': hbEndPortIsInvalid }"
        />
        @if (hbEndPortIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.network.host' | translate }}<br />
        <small class="grey-text pe-2" [innerHtml]="'settings.network.host_desc' | translate"></small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          pattern="^[^{}/ :\\]+(?::\d+)?$"
          [formControl]="uiHostFormControl"
          placeholder="0.0.0.0"
          [attr.aria-label]="('settings.network.host' | translate)"
        />
        @if (uiHostIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.network.proxy' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.network.proxy_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          pattern="^[^{}/ :\\]+(?::\d+)?$"
          placeholder="example.com:8443"
          [formControl]="uiProxyHostFormControl"
          [attr.aria-label]="('settings.network.proxy' | translate)"
        />
        @if (uiProxyHostIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
  </ul>
  }
</div>

<!-- SECURITY SETTINGS -->
<div class="my-4">
  <div
    role="button"
    tabindex="0"
    [attr.aria-expanded]="showFields.security ? 'true' : 'false'"
    [attr.aria-controls]="'fieldsSecurity'"
    (click)="toggleSection('security')"
    class="mt-3 hover-pointer"
  >
    <h5 class="primary-text">
      <i
        class="fa fa-fw"
        [ngClass]="{ 'fa-chevron-down': showFields.security, 'fa-chevron-right': !showFields.security }"
      ></i>
      {{ 'settings.network.title_security' | translate }}
    </h5>
  </div>
  @if (showFields.security) {
  <ul class="list-group list-group-box mt-2 mx-0" id="fieldsSecurity">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.security.auth' | translate }}<br />
        <small class="grey-text pe-2"> {{ 'settings.security.auth_desc' | translate }} </small>
      </span>
      <div class="d-flex align-items-center">
        <div class="order-1 order-md-2">
          <input
            type="checkbox"
            class="rendux-input"
            id="uiAuthForm"
            [formControl]="uiAuthFormControl"
            [attr.aria-label]="'settings.security.auth' | translate"
          />
          <label for="uiAuthForm" class="rendux-label ms-3" style="min-width: 50px"></label>
        </div>
        @if (uiAuthIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    @if (uiAuthFormControl.value) {
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.startup.session' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.startup.session_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="number"
          min="600"
          max="86400000"
          placeholder="28800"
          [formControl]="uiSessionTimeoutFormControl"
          [attr.aria-label]="('settings.startup.session' | translate)"
          [ngClass]="{ 'is-invalid': uiSessionTimeoutIsInvalid }"
        />
        @if (uiSessionTimeoutIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    }
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.security.https' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.security.https_desc' | translate }}</small>
      </span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <select
          class="custom-select resp-select order-1 order-md-2"
          [formControl]="uiSslTypeFormControl"
          [attr.aria-label]="'settings.security.https' | translate"
        >
          <option value="off">{{ 'accessories.control.off' | translate }}</option>
          <option value="keycert">{{ 'settings.security.https_keycert' | translate }}</option>
          <option value="pfx">{{ 'settings.security.https_pfx' | translate }}</option>
        </select>
      </div>
    </li>
    @if (this.uiSslTypeFormControl.value === 'keycert') {
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>{{ 'settings.security.key' | translate }}</span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          placeholder="/Users/.../certs/server.key"
          [formControl]="uiSslKeyFormControl"
          [attr.aria-label]="('settings.security.key' | translate)"
        />
        @if (uiSslKeyIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>{{ 'settings.security.cert' | translate }}</span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          placeholder="/Users/.../certs/server.crt"
          [formControl]="uiSslCertFormControl"
          [attr.aria-label]="('settings.security.cert' | translate)"
        />
        @if (uiSslCertIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    } @if (this.uiSslTypeFormControl.value === 'pfx') {
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>{{ 'settings.security.pfx' | translate }}</span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          type="text"
          placeholder="/Users/.../certs/server.pfx"
          [formControl]="uiSslPfxFormControl"
          [attr.aria-label]="('settings.security.pfx' | translate)"
        />
        @if (uiSslPfxIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-block d-md-flex justify-content-between align-items-center">
      <span>{{ 'settings.security.pass' | translate }}</span>
      <div class="my-3 my-md-0 ps-0 ps-md-5 w-auto d-flex align-items-center">
        <input
          class="form-control custom-input resp-input order-1 order-md-2"
          [type]="showPfxPassphrase ? 'text' : 'password'"
          placeholder="mypassphrase"
          [formControl]="uiSslPassphraseFormControl"
          [attr.aria-label]="('settings.security.pass' | translate)"
          (focus)="showPfxPassphrase = true"
          (blur)="showPfxPassphrase = false"
        />
        @if (uiSslPassphraseIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    }
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2">
        {{ 'settings.security.ui_control' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.security.ui_control_desc' | translate }}</small>
      </span>
      <button
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        (click)="accessoryUiControl()"
        [attr.aria-label]="'settings.security.ui_control' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </button>
    </li>
  </ul>
  }
</div>

<!-- CACHE SETTINGS -->
<div class="my-4">
  <div
    role="button"
    tabindex="0"
    [attr.aria-expanded]="showFields.cache ? 'true' : 'false'"
    [attr.aria-controls]="'fieldsCache'"
    (click)="toggleSection('cache')"
    class="mt-3 hover-pointer"
  >
    <h5 class="primary-text">
      <i
        class="fa fa-fw"
        [ngClass]="{ 'fa-chevron-down': showFields.cache, 'fa-chevron-right': !showFields.cache }"
      ></i>
      {{ 'menu.label_accessories' | translate }}
    </h5>
  </div>
  @if (showFields.cache) {
  <p class="small grey-text mb-2 mx-0">{{ 'settings.cache.desc' | translate }}</p>
  } @if (showFields.cache) {
  <ul class="list-group list-group-box mb-4 mx-0" id="fieldsCache">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.accessory.debug' | translate }}<br />
        <small class="grey-text pe-2">{{ 'settings.accessory.debug_desc' | translate }}</small>
      </span>
      <div class="d-flex align-items-center">
        <div class="order-1 order-md-2">
          <input
            type="checkbox"
            class="rendux-input"
            id="accessoryDebug"
            [formControl]="uiAccDebugFormControl"
            [attr.aria-label]="'settings.accessory.debug' | translate"
          />
          <label for="accessoryDebug" class="rendux-label ms-3" style="min-width: 50px"></label>
        </div>
        @if (uiAccDebugIsSaving) {
        <i
          @fadeInOut
          class="fas fa-fw fa-floppy-disk primary-text fa-xl me-0 me-md-2 ms-2 ms-md-0 order-2 order-md-1"
        ></i>
        }
      </div>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2">
        {{ 'reset.accessory_ind.title' | translate }}<br />
        <small class="grey-text pe-2">{{ 'reset.accessory_ind.desc' | translate }}</small>
      </span>
      <button
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        (click)="removeSingleCachedAccessories()"
        [attr.aria-label]="'reset.accessory_ind.title' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2">
        {{ 'reset.bridge_accessories.title' | translate }}<br />
        <small class="grey-text pe-2">{{ 'reset.bridge_accessories.desc' | translate }}</small>
      </span>
      <button
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        (click)="removeBridgeAccessories()"
        [attr.aria-label]="'reset.accessory_all.title' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2">
        {{ 'reset.accessory_all.title' | translate }}<br />
        <small class="grey-text pe-2">{{ 'reset.accessory_all.desc' | translate }}</small>
      </span>
      <button
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        (click)="removeAllCachedAccessories()"
        [attr.aria-label]="'reset.accessory_all.title' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </button>
    </li>
  </ul>
  }
</div>

<!-- RESET SETTINGS -->
<div class="my-4">
  <div
    role="button"
    tabindex="0"
    [attr.aria-expanded]="showFields.reset ? 'true' : 'false'"
    [attr.aria-controls]="'fieldsReset'"
    (click)="toggleSection('reset')"
    class="mt-3 hover-pointer"
  >
    <h5 class="primary-text">
      <i
        class="fa fa-fw"
        [ngClass]="{ 'fa-chevron-down': showFields.reset, 'fa-chevron-right': !showFields.reset }"
      ></i>
      {{ 'reset.bridges.title' | translate }}
    </h5>
  </div>
  @if (showFields.reset) {
  <p class="small grey-text mb-2 mx-0">{{ 'reset.bridges.desc' | translate }}</p>
  } @if (showFields.reset) {
  <ul class="list-group list-group-box mt-2 mx-0" id="fieldsReset">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2">
        {{ 'reset.bridge_ind.title' | translate }}<br />
        <small class="grey-text pe-2">{{ 'reset.bridge_ind.desc' | translate }}</small>
      </span>
      <button
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        (click)="unpairAccessory()"
        [attr.aria-label]="'reset.bridge_ind.title' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pe-2">
        {{ 'reset.bridge_all.title' | translate | titlecase }}<br />
        <small class="grey-text pe-2">{{ 'reset.bridge_all.desc' | translate }}</small>
      </span>
      <button
        class="btn btn-primary waves-effect m-0 ms-3"
        style="min-width: 50px"
        (click)="resetHomebridgeState()"
        [attr.aria-label]="'reset.bridge_all.title' | translate"
      >
        <i class="fas fa-fw fa-arrow-right"></i>
      </button>
    </li>
  </ul>
  }
</div>
<div class="pb-3"></div>
}
